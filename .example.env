################################################################################
# RAILWAY DEPLOYMENT GUIDE
################################################################################
# 
# 1. Create a new project in Railway (https://railway.app)
# 
# 2. Add PostgreSQL database:
#    - Click "+ New" → Database → Add PostgreSQL
#    - Railway automatically provides: DATABASE_URL
#
# 3. Add Redis database:
#    - Click "+ New" → Database → Add Redis  
#    - Railway automatically provides: REDIS_URL
#
# 4. (Optional) Add Resend for email:
#    - Click "+ New" → Service → Search for Resend
#    - Get your API key from https://resend.com/api-keys
#
# 5. Add your application service:
#    - Click "+ New" → GitHub Repo (or Empty Service)
#    - Connect your Kutt repository
#
# 6. Configure environment variables in your app service's Variables tab:
#    Copy these EXACTLY (see railway-env-template.txt for easy copy-paste):
#
#      JWT_SECRET=${{secret(32)}}
#      DEFAULT_DOMAIN=your-app.up.railway.app
#      DATABASE_URL=${{DATABASE_URL}}
#      REDIS_URL=${{REDIS_URL}}
#
#    That's it! Railway automatically links the services through these URLs.
#    See railway-env-template.txt for the complete configuration.
#
# 7. For Resend email (optional):
#    Get your API key from https://resend.com and add:
#      RESEND_API_KEY=re_your_api_key_here
#      MAIL_ENABLED=true
#
# 8. Railway Configuration Files (already created for you):
#    - railway.json: Configures build and deploy settings
#    - nixpacks.toml: Specifies Node.js version and build process
#    These files ensure migrations run before the app starts
#
# 9. Deploy! Railway will automatically build and deploy your app.
#    - DATABASE_URL and REDIS_URL are automatically available
#    - JWT_SECRET is auto-generated using ${{secret(32)}}
#    - Migrations run automatically on each deployment
#    - The app will restart on failure (max 10 retries)
#
# NOTE: Railway's ${{secret(32)}} function generates a secure 32-character random string
#       Railway's ${{DATABASE_URL}} and ${{REDIS_URL}} automatically reference your services
#
################################################################################

# Optional - App port to run on
# Railway automatically sets PORT, so you can leave this empty for Railway deployments
PORT=3000

# Optional - The name of the site where Kutt is hosted
SITE_NAME=Kutt

# REQUIRED FOR RAILWAY - The domain that this website is on
# For Railway, use your Railway app domain (e.g., your-app.up.railway.app)
# You can find this in Railway dashboard under Settings → Domains
DEFAULT_DOMAIN=

# REQUIRED FOR RAILWAY - A passphrase to encrypt JWT
# In Railway, use: JWT_SECRET=${{secret(32)}}
# Railway auto-generates a secure 32-character random string
# 
# For local development, generate with:
# openssl rand -base64 32
# OR: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
JWT_SECRET=

# Optional - Database client. Available clients for the supported databases:
# pg | better-sqlite3 | mysql2
# other supported drivers that you can use but you have to manually install them with npm:
# pg-native | sqlite3 | mysql
# For Railway with PostgreSQL, use: pg
DB_CLIENT=pg

# Optional - SQLite database file path
# Only if you're using SQLite (not recommended for Railway)
DB_FILENAME=db/data

DATABASE_PUBLIC_URL="postgresql://${{Postgres.PGUSER}}:${{Postgres.POSTGRES_PASSWORD}}@${{Postgres.RAILWAY_TCP_PROXY_DOMAIN}}:${{Postgres.RAILWAY_TCP_PROXY_PORT}}/${{Postgres.PGDATABASE}}"
DATABASE_URL="${{Postgres.DATABASE_URL}}"
PGDATA="/var/lib/postgresql/data/pgdata"
PGDATABASE="${{Postgres.POSTGRES_DB}}"
PGHOST="${{Postgres.RAILWAY_PRIVATE_DOMAIN}}"
PGPASSWORD="${{Postgres.POSTGRES_PASSWORD}}"
PGPORT="5432"
PGUSER="${{Postgres.POSTGRES_USER}}"
POSTGRES_DB="railway"
POSTGRES_PASSWORD=""
POSTGRES_USER="postgres"
RAILWAY_DEPLOYMENT_DRAINING_SECONDS="60"
SSL_CERT_DAYS="820"

# Optional - Generated link length
LINK_LENGTH=6

# Optional - Alphabet used to generate custom addresses
# Default value omits o, O, 0, i, I, l, 1, and j to avoid confusion when reading the URL
LINK_CUSTOM_ALPHABET=abcdefghkmnpqrstuvwxyzABCDEFGHKLMNPQRSTUVWXYZ23456789

# Optional - Tells the app that it's running behind a proxy server
# and that it should get the IP address from that proxy server
# if you're not using a proxy server then set this to false, otherwise users can override their IP address
TRUST_PROXY=true

# RAILWAY REDIS: When you add Redis service in Railway, it automatically provides REDIS_URL
# In Railway Variables, just add: REDIS_URL=${{REDIS_URL}}
# The app automatically parses REDIS_URL to extract host, port, password, etc.
# No need to set individual REDIS_* variables when using REDIS_URL!

REDIS_PASSWORD=""
REDIS_PUBLIC_URL="redis://default:${{Redis.REDIS_PASSWORD}}@${{Redis.RAILWAY_TCP_PROXY_DOMAIN}}:${{Redis.RAILWAY_TCP_PROXY_PORT}}"
REDIS_URL="${{Redis.REDIS_URL}}"
REDISHOST="${{Redis.RAILWAY_PRIVATE_DOMAIN}}"
REDISPASSWORD="${{Redis.REDIS_PASSWORD}}"
REDISPORT="6379"
REDISUSER="default"

# Optional - Disable registration. Default is true.
DISALLOW_REGISTRATION=true

# Optional - Disable anonymous link creation. Default is true.
DISALLOW_ANONYMOUS_LINKS=true

# Optional - This would be shown to the user on the settings page
# It's only for display purposes and has no other use
SERVER_IP_ADDRESS=
SERVER_CNAME_ADDRESS=

# Optional - Use HTTPS for links with custom domain
# It's on you to generate SSL certificates for those domains manually, at least on this version for now
CUSTOM_DOMAIN_USE_HTTPS=false

# Optional - Email is used to verify or change email address, reset password, and send reports.
# If it's disabled, all the above functionality would be disabled as well.
# MAIL_FROM example: "Kutt <support@kutt.it>". Leave it empty to use MAIL_USER.
# More info on the configuration on http://nodemailer.com/.
# 
# For Railway, RESEND is recommended - simple, modern, developer-friendly:
# 1. Sign up at https://resend.com (100 free emails/day)
# 2. Get API key from https://resend.com/api-keys
# 3. Set: MAIL_HOST=smtp.resend.com, MAIL_PORT=465, MAIL_USER=resend, MAIL_PASSWORD=re_your_api_key
# 
# Other options:
# - SendGrid: smtp.sendgrid.net:587
# - Mailgun: smtp.mailgun.org:587
# - Postmark: smtp.postmarkapp.com:587
MAIL_ENABLED=false
MAIL_HOST=
MAIL_PORT=587
MAIL_SECURE=true
MAIL_USER=
MAIL_FROM=
MAIL_PASSWORD=

# Optional - Enable rate limitting for some API routes
ENABLE_RATE_LIMIT=false

# Optional - The email address that will receive submitted reports
REPORT_EMAIL=

# Optional - Support email to show on the app
CONTACT_EMAIL=
